import{r as h,p as S,j as e}from"./index-DMyFwfPw.js";import{a as w}from"./axios-upsvKRUO.js";import{C as E}from"./CCard-BxMFv-c9.js";import{C as A}from"./CForm-CqyU06G5.js";import{C as o}from"./CCol-OKn3_WcL.js";import{C as v,a as g}from"./CFormTextarea-DHvEPV8Y.js";import{C as p}from"./CFormInput-CXwMbvwB.js";import{c as d}from"./index.esm-C08VXAn-.js";const I=()=>{const[s,i]=h.useState({name:"",description:"",description_fr:"",duration:"monthly",price:"",features:[""],features_fr:[""]}),[x,j]=h.useState(""),F=S(),[T,_]=h.useState(""),c=t=>{const{name:r,value:a}=t.target;i(n=>({...n,[r]:a}))},C=(t,r,a)=>{const n=a==="fr"?[...s.features_fr]:[...s.features];n[t]=r,i(l=>({...l,[a==="fr"?"features_fr":"features"]:n}))},b=t=>{i(t==="fr"?r=>({...r,features_fr:[...r.features_fr,""],features:[...r.features,""]}):r=>({...r,features:[...r.features,""],features_fr:[...r.features_fr,""]}))},y=(t,r)=>{const a=r==="fr"?s.features_fr:s.features,n=r==="fr"?s.features:s.features_fr,l=a.filter((f,m)=>m!==t),u=n.filter((f,m)=>m!==t);i(f=>({...f,[r==="fr"?"features_fr":"features"]:l,[r==="fr"?"features":"features_fr"]:u}))},N=async t=>{var n,l;if(t.preventDefault(),!s.name||!s.description||!s.price){j("Tous les champs doivent être remplis.");return}const r=s.features.length===1&&typeof s.features[0]=="string"?s.features[0]:s.features,a={...s,features:r};try{const u=await w.post("http://localhost:5000/api/addsubscription",a);_("Le plan a été ajouté avec succès!"),setTimeout(()=>{F("/admin/listplan")},2e3)}catch(u){console.error("Erreur lors de la soumission",u),j(((l=(n=u.response)==null?void 0:n.data)==null?void 0:l.message)||"Erreur lors de la création de l'abonnement")}};return e.jsxs("div",{className:"p-5",children:[e.jsx("h2",{style:{fontWeight:700,fontSize:"20px"},children:"ADD PLAN"}),x&&e.jsx("div",{className:"alert alert-danger",children:x}),e.jsx(E,{className:"p-5",style:{background:"white"},children:e.jsxs(A,{onSubmit:N,className:"row g-3",children:[e.jsx(o,{md:12,children:e.jsxs(v,{label:"Name",name:"name",value:s.name,onChange:c,required:!0,children:[e.jsx("option",{value:"home",children:"STARTER"}),e.jsx("option",{value:"small",children:"SMALL"}),e.jsx("option",{value:"pro",children:"ENTERPRISE"})]})}),e.jsx(o,{xs:12,children:e.jsx(g,{label:"Description",name:"description",value:s.description,onChange:c,required:!0})}),e.jsx(o,{md:6,children:e.jsxs(v,{label:"Duration",name:"duration",value:s.duration,onChange:c,required:!0,children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})}),e.jsx(o,{md:6,children:e.jsx(p,{type:"number",label:"Price",name:"price",value:s.price,onChange:c,min:"0",required:!0})}),e.jsx(o,{xs:12,children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Features (English)"}),s.features.map((t,r)=>e.jsxs("div",{className:"d-flex mb-2",children:[e.jsx(p,{type:"text",value:t,onChange:a=>C(r,a.target.value,"en"),className:"me-2",required:!0}),r>0&&e.jsx(d,{style:{color:"white"},color:"danger",type:"button",onClick:()=>y(r,"en"),children:"Delete"})]},r)),e.jsx(d,{style:{color:"white"},color:"success",type:"button",onClick:()=>b("en"),children:"Add Feature"})]})}),e.jsx("h2",{style:{fontWeight:700,fontSize:"18px"},children:"french Version"}),e.jsx("br",{}),e.jsx(o,{xs:12,children:e.jsx(g,{label:"Description (French)",name:"description_fr",value:s.description_fr,onChange:c,required:!0})}),e.jsx(o,{xs:12,children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Features (French)"}),s.features_fr.map((t,r)=>e.jsxs("div",{className:"d-flex mb-2",children:[e.jsx(p,{type:"text",value:t,onChange:a=>C(r,a.target.value,"fr"),className:"me-2",required:!0}),r>0&&e.jsx(d,{style:{color:"white"},color:"danger",type:"button",onClick:()=>y(r,"fr"),children:"Delete"})]},r)),e.jsx(d,{color:"success",style:{color:"white"},type:"button",onClick:()=>b("fr"),children:"Add Feature"})]})}),e.jsx(o,{xs:12,children:e.jsx(d,{color:"primary",type:"submit",children:"Add Plan"})})]})})]})};export{I as default};
