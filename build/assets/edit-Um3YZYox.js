import{r as f,p as q,q as T,j as e}from"./index-DMyFwfPw.js";import{a as F}from"./axios-upsvKRUO.js";import{C as M}from"./CCard-BxMFv-c9.js";import{C as P}from"./CForm-CqyU06G5.js";import{C as o}from"./CCol-OKn3_WcL.js";import{C as _,a as S}from"./CFormTextarea-DHvEPV8Y.js";import{C as j}from"./CFormInput-CXwMbvwB.js";import{c as d}from"./index.esm-C08VXAn-.js";const $=()=>{const[s,i]=f.useState({name:"",description:"",description_fr:"",duration:"",price:"",features:[""],features_fr:[""]}),[b,m]=f.useState(""),[C,E]=f.useState(""),N=q(),{id:h}=T();f.useEffect(()=>{(async()=>{try{const r=await F.get(`http://localhost:5000/api/editsubscriptions/${h}`);i(r.data.subscription)}catch(r){console.error("Erreur lors de la récupération de l'abonnement:",r),m("Impossible de récupérer les données de l'abonnement.")}})()},[h]);const c=t=>{const{name:r,value:a}=t.target;i(n=>({...n,[r]:a}))},y=(t,r,a)=>{const n=a==="fr"?[...s.features_fr]:[...s.features];n[t]=r,i(l=>({...l,[a==="fr"?"features_fr":"features"]:n}))},v=t=>{i(t==="fr"?r=>({...r,features_fr:[...r.features_fr,""],features:[...r.features,""]}):r=>({...r,features:[...r.features,""],features_fr:[...r.features_fr,""]}))},g=(t,r)=>{const a=r==="fr"?s.features_fr:s.features,n=r==="fr"?s.features:s.features_fr,l=a.filter((p,x)=>x!==t),u=n.filter((p,x)=>x!==t);i(p=>({...p,[r==="fr"?"features_fr":"features"]:l,[r==="fr"?"features":"features_fr"]:u}))},w=async t=>{var n,l;if(t.preventDefault(),!s.name||!s.description||!s.price){m("Tous les champs doivent être remplis.");return}const r=s.features.length===1&&typeof s.features[0]=="string"?s.features[0]:s.features,a={...s,features:r};try{const u=await F.put(`http://localhost:5000/api/updatesubscriptions/${h}`,a);E("Les modifications ont été enregistrées avec succès!"),setTimeout(()=>{N("/admin/listplan")},2e3)}catch(u){console.error("Erreur lors de la soumission",u),m(((l=(n=u.response)==null?void 0:n.data)==null?void 0:l.message)||"Erreur lors de la mise à jour de l'abonnement")}};return e.jsxs("div",{className:"p-5",children:[e.jsx("h2",{style:{fontWeight:700,fontSize:"20px"},children:"Edit Plan"}),b&&e.jsx("div",{className:"alert alert-danger",children:b}),C&&e.jsx("div",{className:"alert alert-success",children:C}),e.jsx(M,{className:"p-5",style:{background:"white"},children:e.jsxs(P,{onSubmit:w,className:"row g-3",children:[e.jsx(o,{md:12,children:e.jsxs(_,{label:"Name",name:"name",value:s.name,onChange:c,required:!0,children:[e.jsx("option",{value:"home",children:"STARTER"}),e.jsx("option",{value:"small",children:"SMALL"}),e.jsx("option",{value:"pro",children:"ENTERPRISE"})]})}),e.jsx(o,{xs:12,children:e.jsx(S,{label:"Description",name:"description",value:s.description,onChange:c,required:!0})}),e.jsx(o,{md:6,children:e.jsxs(_,{label:"Duration",name:"duration",value:s.duration,onChange:c,required:!0,children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})}),e.jsx(o,{md:6,children:e.jsx(j,{type:"number",label:"Price",name:"price",value:s.price,onChange:c,min:"0",required:!0})}),e.jsx(o,{xs:12,children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Features (English)"}),s.features.map((t,r)=>e.jsxs("div",{className:"d-flex mb-2",children:[e.jsx(j,{type:"text",value:t,onChange:a=>y(r,a.target.value,"en"),className:"me-2",required:!0}),r>0&&e.jsx(d,{style:{color:"white"},color:"danger",type:"button",onClick:()=>g(r,"en"),children:"Delete"})]},r)),e.jsx(d,{style:{color:"white"},color:"success",type:"button",onClick:()=>v("en"),children:"Add Feature"})]})}),e.jsx("h2",{style:{fontWeight:700,fontSize:"18px"},children:"French Version"}),e.jsx("br",{}),e.jsx(o,{xs:12,children:e.jsx(S,{label:"Description (French)",name:"description_fr",value:s.description_fr,onChange:c,required:!0})}),e.jsx(o,{xs:12,children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{children:"Features (French)"}),s.features_fr.map((t,r)=>e.jsxs("div",{className:"d-flex mb-2",children:[e.jsx(j,{type:"text",value:t,onChange:a=>y(r,a.target.value,"fr"),className:"me-2",required:!0}),r>0&&e.jsx(d,{style:{color:"white"},color:"danger",type:"button",onClick:()=>g(r,"fr"),children:"Delete"})]},r)),e.jsx(d,{color:"success",style:{color:"white"},type:"button",onClick:()=>v("fr"),children:"Add Feature"})]})}),e.jsx(o,{xs:12,children:e.jsx(d,{color:"primary",type:"submit",children:"Update Plan"})})]})})]})};export{$ as default};
